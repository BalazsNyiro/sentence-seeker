<!DOCTYPE html>
<html>
<style>
body {
  background-image: url('img/bg.jpg');
}

.source_name {
    color: green;
    text-align: right;
}
#Licenses {
    text-align: center;
}
.seek {
    width: 500px;
    margin-left:auto;
    margin-right:auto;
}
table {
}
#contact {
    text-align: center;
}
#demo {
    width: 500px;
    margin-left:auto;
    margin-right:auto;
    border: 3px;
}

</style>
<head>
    <meta charset="UTF-8">
    <title>sentence-seeker.net - Get sentence examples from docs</title>
</head>
<body id="body">
<!-- https://www.create.net/blog/free-social-media-icons#facebook -->
<p id="contact"><a href="https://www.facebook.com/groups/2449430305347843" target="_blank"><img alt="sentence-reader.net facebook group" src="https://c866088.ssl.cf3.rackcdn.com/assets/facebook40x40.png" border=0  width="12" height="12"></a> <a href="mailto:diogeneszATpergamenDOThu">ðŸ“§</a></p>
<div class="seek">
    <label>Words:</label><br>
    <input type="text" id="words" name="words" value="PLACEHOLDER_QUERY_EXAMPLE" size="50"><br>
    <button id="button_seek" onclick="seek_func()">Get example sentences...</button>
    <p id="message"></p>

</div>

<script type="text/javascript" src="hilitor.js"></script>
<p id="demo"></p>
<p id="Licenses">PLACEHOLDER_LICENSE</p>
<script>

    var input = document.getElementById("words");
    input.addEventListener("keyup", function(event) {
      if (event.keyCode === 13) { // Number 13 is the "Enter" key on the keyboard
        // Cancel the default action, if needed
        event.preventDefault();
        // Trigger the button element with a click
        document.getElementById("button_seek").click();
      }
    });

    var wordHilitor; // https://e-motiv.github.io/hilitor/example/#example
    function source_display(BaseName){
        DocInfo = PLACEHOLDER_DOCUMENT_JSON;
        for (var key in DocInfo.docs) {
            if (key == BaseName) {
                Elem = DocInfo.docs[key];
                return "<a target='_blank' href='"+Elem.url+"'>" + DocInfo["source_names"][Elem.source_name] + "</a>";
            }
        }
        return BaseName;
    }
    function message(Msg){
        document.getElementById("message").innerHTML = Msg;
    }

    function seek_func(){
        message("<b>Seeking...</b>");

        let Words = document.getElementById("words").value;

        let WordsWithoutOperators = Words;
        let Remove = ["(", ")", "AND", "OR", ","];
        Remove.forEach(clear);
        function clear(Deleted) {
          while (WordsWithoutOperators.includes(Deleted)) {
            WordsWithoutOperators = WordsWithoutOperators.replace(Deleted, "");
          }
        }

        var obj, dbParam, xmlhttp, Results, x, txt = "";
        obj = { table: "sentences", limit: 20 };
        dbParam = JSON.stringify(obj);
        xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {

          wordHilitor = new Hilitor("body");

          if (this.readyState == 4 && this.status == 200) {
            Response = JSON.parse(this.responseText);
            Results = Response.results;
            txt += Response.token_process_explain + "<table border='1'>";
            for (x in Results) {
              txt += "<tr><td>" + Results[x].Sentence + "<br /><div class='source_name'>" + source_display(Results[x].FileSourceBaseName) + "</div>" + "</td></tr>";
            }
            txt += "</table>";
            document.getElementById("demo").innerHTML = txt;

            wordHilitor.apply(WordsWithoutOperators );

            message("<b></b>");
          }
        };

        xmlhttp.open("GET", "http://PLACEHOLDER_HOST:PLACEHOLDER_PORT/seek?words=" + Words, true);
        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xmlhttp.send("x=" + dbParam);
    }

    </script>


</body>
</html>
